(function(a){a(function(){var d=false;a("form.checkout").on("click","#place_order",function(){return g()});a("form.checkout").on("checkout_place_order_pagarme-credit-card",{preservePagarmeCheckoutSubmitValue:true},f);a("form#order_review").submit(function(){return g()});function e(){var i=false;if("1"===a("#billing_persontype").val()){a("#billing_cpf, #billing_rg").each(function(){if(""===a(this).val()){i=true}})}else{if("2"===a("#billing_persontype").val()){a("#billing_cnpj, #billing_company, #billing_ie").each(function(){if(""===a(this).val()){i=true}})}}return i}function f(i){var j=null;if(d){if("undefined"!==typeof i&&"undefined"!==typeof i.data){if("undefined"!==typeof i.data.preservePagarmeCheckoutSubmitValue&&!i.data.preservePagarmeCheckoutSubmitValue){d=false}}return true}if(!a("#payment_method_pagarme-credit-card").is(":checked")){return true}if(0<a("input[name=pagarme_checkout_token]").length){return true}if(1===a("input#terms").size()&&0===a("input#terms:checked").size()){return true}if(a("#createaccount").is(":checked")&&a("#account_password").length&&""===a("#account_password").val()){return true}if(a("#ship-to-different-address-checkbox").is(":checked")){j=a(".woocommerce-billing-fields .validate-required, .woocommerce-shipping-fields .validate-required")}else{j=a(".woocommerce-billing-fields .validate-required")}if(j.size()){var k=false;if(0<a("#billing_persontype").length){j.each(function(){if(""===a(this).find("input.input-text, select").not(a("#account_password, #account_username, #billing_cpf, #billing_rg, #billing_cnpj, #billing_company, #billing_ie")).val()){k=true}});if(!k){k=e()}}else{j.each(function(){if(""===a(this).find("input.input-text, select").not(a("#account_password, #account_username")).val()){k=true}})}if(k){return true}}return false}function h(i){return 0<i.length}function c(i){return i.replace(/[^\d]/g,"")}function b(j){var i,k={};k.customerName=a.trim(a("#billing_first_name",j).val()+" "+a("#billing_last_name",j).val());k.customerEmail=a("#billing_email",j).val();if(h(a("#billing_address_1"))){k.customerAddressStreet=a("#billing_address_1").val();k.customerAddressComplementary=a("#billing_address_2").val();k.customerAddressZipcode=c(a("#billing_postcode").val());if(h(a("#billing_number"))){k.customerAddressStreetNumber=a("#billing_number").val()}if(h(a("#billing_neighborhood"))){k.customerAddressNeighborhood=a("#billing_neighborhood").val()}}if(h(a("#billing_phone"))){i=c(a("#billing_phone").val());k.customerPhoneDdd=i.substr(0,2);k.customerPhoneNumber=i.substr(2)}if(h(a("#billing_persontype"))){if("1"===a("#billing_persontype").val()){k.customerDocumentNumber=c(a("#billing_cpf").val())}else{k.customerName=a("#billing_company").val();k.customerDocumentNumber=c(a("#billing_cnpj").val())}}else{if(h(a("#billing_cpf"))){k.customerDocumentNumber=c(a("#billing_cpf").val())}else{if(h(a("#billing_cnpj"))){k.customerName=a("#billing_company").val();k.customerDocumentNumber=c(a("#billing_cnpj").val())}}}return k}function g(){if(f()){return true}var j,l,m,k=a("form.checkout, form#order_review"),i=a("#pagarme-checkout-params",k);j=new PagarMeCheckout.Checkout({encryption_key:wcPagarmeParams.encryptionKey,success:function(n){d=true;if(wcPagarmeParams.token==="true"){a("input[name=pagarme_checkout_token]",k).remove();k.append(a('<input name="pagarme_checkout_token" type="hidden" />').val(n.token))}else{a("input[name=pagarme_card_hash]",k).remove();k.append(a('<input name="pagarme_card_hash" type="hidden" />').val(n.card_hash));k.append(a('<input name="pagarme_installments" type="hidden" />').val(n.installments))}k.submit()}});if(wcPagarmeParams.checkoutPayPage){l=wcPagarmeParams.customerFields}else{l=b(k)}m=a.extend({},{paymentMethods:"credit_card",customerData:false,amount:i.data("total"),createToken:wcPagarmeParams.token,interestRate:wcPagarmeParams.interestRate,maxInstallments:i.data("max_installment"),freeInstallments:wcPagarmeParams.freeInstallments,postbackUrl:wcPagarmeParams.postbackUrl,uiColor:wcPagarmeParams.uiColor},l);j.open(m);return false}})}(jQuery));